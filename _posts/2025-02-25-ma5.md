---
title: "파밍"
categories:
  - Malware Analysis
tags:
  - 악성코드 분석
layout: archive
layout: single
author_profile: true
sidebar_main: true
toc: true
toc_sticky: true
toc_label: "목차"
---

# 파밍 악성코드 분석 보고서

## 악성코드 순서도
![image](https://github.com/user-attachments/assets/fc61ac08-b0db-4bf2-a139-d48fe6a2518a)

## 악성코드 동작과정
1. 패킹이 된 악성 코드를 매뉴얼 언패킹을 진행하여 패킹을 해제
2. sub_401966 실행, koreaautoup.bmp 파일 생성, 원본 악성 코드 Temp 경로 및 Common File 경로에 복사 한 뒤 원본 악성 코드 제거
3. Software\\Microsoft\\Windows\\CurrentVersion\\Run, Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings, Software\\Microsoft\\Internet Explorer\\Main\\Start Page (www.naver.com) 레지스트리 변조 (자동 업데이트, DNS 설정, 시작 페이지 설정 등을 제어)
4. sub_4026D8 실행, iexplorer를 사용하여 http://kt.tobeuapk.com/lude.html 웹사이트 실행
5. sub_4027EE 실행, http://user.qzone.qq.com/1055869208와 네트워크 통신 진행
6. 네트워크 통신 진행 시 HttpSendRequest를 통해 send를 보낸 뒤 버퍼에 악성 파일 다운로드
7. hosts, hosts.ics 파일 변조 후 자바 스크립트 코드를 웹 페이지에 삽입하여 금융 사이트에 접속 시 강제 리다이렉트 시키고 qq.com에서 파밍 수행(MITM)

## 악성코드 세부분석
